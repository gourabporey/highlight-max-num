<html>
  <head>
    <title>Maximum number hightlighter</title>

    <link
      rel="stylesheet"
      href="style.css" />

    <script>
      const isInvalid = (number) =>
        typeof number !== 'number' || isNaN(number) || number === null;

      const createNumberNode = (number) => {
        const numberNode = document.createElement('p');
        numberNode.innerText = number;
        return numberNode;
      };

      const getNumberContainer = () => document.querySelector('#numbers');

      const readNumber = (msg, cb, timeout = 100) => {
        setTimeout(() => {
          cb(+prompt(msg));
        }, timeout);
      };

      const updateNumbers = (numbers, number) => {
        const isGreaterThanPivot = number > numbers.pivot;
        const numberGroup = isGreaterThanPivot ? 'greater' : 'lesser';
        return {
          ...numbers,
          [numberGroup]: [...numbers[numberGroup], number],
        };
      };

      const displayNumberGroup = (header, numbers) => {
        if (numbers.length === 0) return;
        const numberContainer = getNumberContainer();

        const groupHeader = document.createElement('h4');
        groupHeader.innerText = header;
        const groupNumbersContainer = document.createElement('div');

        const sortedNumbers = numbers.toSorted((a, b) => a - b);
        const numberNodes = sortedNumbers.map(createNumberNode);

        groupNumbersContainer.append(groupHeader, ...numberNodes);
        numberContainer.appendChild(groupNumbersContainer);
      };

      const displayNumbers = (numbers) => {
        const { pivot, greater, lesser } = numbers;
        const numberContainer = getNumberContainer();

        [...numberContainer.children].forEach((child) =>
          numberContainer.removeChild(child)
        );

        displayNumberGroup(`Numbers <= ${pivot}: `, lesser);
        displayNumberGroup(`Numbers > ${pivot}: `, greater);
      };

      const collectAndDisplayNumbers = (remainingCount, numbers) => {
        if (remainingCount <= 0) {
          return;
        }

        readNumber('Enter a number', (number) => {
          if (isInvalid(number)) return;
          const updatedNumbers = updateNumbers(numbers, number);
          displayNumbers(updatedNumbers);
          collectAndDisplayNumbers(remainingCount - 1, updatedNumbers);
        });
      };

      window.onload = () => {
        const numbersCount = 3;
        const numbers = {
          pivot: 6,
          greater: [],
          lesser: [],
        };
        collectAndDisplayNumbers(numbersCount, numbers);
      };
    </script>
  </head>
  <body>
    <main>
      <h2>Numbers</h2>
      <div id="numbers"></div>
    </main>
  </body>
</html>
